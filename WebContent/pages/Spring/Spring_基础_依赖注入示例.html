<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="author" content="Eric Zong">
<title></title>
<link type="text/css" rel="stylesheet" href="../../css/common.css"  />
<link type="text/css" rel="stylesheet" href="../../css/print.css" media="print" />
<link type="text/css" rel="stylesheet" href="../../css/title.css"  />
<link type="text/css" rel="stylesheet" href="../../css/tree.css" />
<link type="text/css" rel="stylesheet" href="../../css/highlight.css" />

<script type="text/javascript" src="../../js/title.js"></script>
<script type="text/javascript" src="../../js/highlight.pack.js"></script>
<script type="text/javascript">hljs.initHighlightingOnLoad();</script>
</head>
<body>

<h1>基本配置</h1>

<pre class="code"><code class="xml">
&lt;beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
                        http://www.springframework.org/schema/beans/spring-beans.xsd">
  
    &lt;bean id="..." class="...">&lt;/bean>
&lt;/beans> </code></pre>

<h1>示例</h1>

<h2>代码</h2>

<p class="next">Person 类：</p>
<pre class="code"><code class="java">
public class Person
{
    private String name;
    private int age;
    private String msg;

    private Dog dog;

    public Person(String name, int age)
    {
        this.name = name;
        this.age = age;
    }

    // 注意该构造器参数个数与上面一致，仅第二参数不一样
    public Person(String name, String msg)
    {
        this.name = name;
        this.msg = msg;
    }

    // 必要的 getter 和 setter 方法，省略
}
</code></pre>

<p class="next">Dog 类：</p>
<pre class="code"><code class="java">
public class Dog
{
    private String name;

    private Person host;
    
    // 必要的 getter 和 setter 方法，省略
}
</code></pre>

<h2>配置文件</h2>
<pre class="code"><code class="xml">
    &lt;bean id="person" class="com.ericzong.tutorial.spring.basedi.Person">
        &lt;constructor-arg value="Eric" />
        &lt;constructor-arg name="age">
            &lt;value>30&lt;/value>
        &lt;/constructor-arg>
        &lt;property name="dog">
            &lt;ref bean="dog"/> &lt;!-- ④ -->
        &lt;/property>
        &lt;property name="msg">
            &lt;value>测试&lt;/value> &lt;!-- ③ -->
        &lt;/property>
    &lt;/bean>
    
    &lt;bean id="dog" class="com.ericzong.tutorial.spring.basedi.Dog">
        &lt;property name="name" value="JuanJuan" /> &lt;!-- ① -->
        &lt;property name="host" ref="person" /> &lt;!-- ② -->
    &lt;/bean>
</code></pre>

<p class="next">说明：</p>
<div class="textarea">
  <p>依赖注入主要分两种：设值注入和构造注入。</p>
  <p>设值注入，即调用 setter 方法注入值。
  <p>简单如 ①②，分别用 &lt;property> 元素的 value 和 ref 属性指定普通值和引用值。</p>
  <p>当然，也可以像 ③④ 那样，用 &lt;property> 元素的 &lt;value> 和 &lt;ref> 子元素指定值。注意：&lt;ref> 元素是用 bean 属性指定引用 bean id 的。</p>
  <p>构造注入，即对构造器注入参数。</p>
  <p>构造注入与设值注入大体类似，只是使用的是 &lt;constructor-arg> 元素。</p>
</div>

<p class="next">注意：</p>
<div class="ext">
  <p>虽然，从配置形式上来说，设值注入与构造注入很相似。但严格说来，是有差异的。</p>
  <p class="bold">设值注入</p>
  <p>对于设值注入来说，每个 &lt;property> 元素都对应一个 setter 方法的调用。</p>
  <p>通常来说，设值注入使用属性指定值比使用子元素来指定更简洁。</p>
  <p class="bold">构造注入</p>
  <p>相对的，构造注入只调用一个构造器，如果存在多个构造器就会根据 &lt;constructor-arg> 元素（可能有多个）配置来决定调用哪一个构造器。 </p>
  <p>通常情况下，我们只指定构造参数的值。</p>
  <p>此时，参数传入的顺序就是配置的顺序。但如果想人为控制参数传入的顺序可以使用 index 属性指定。</p>
  <p>如果构造器被重载了，我们需要手动指定额外属性来精确匹配构造器。</p>
  <p>由于重载的构造器不同的参数名称通常不同，所以我们可能依靠指定 name 属性来精确匹配构造器。</p>
  <p>当然，也可以使用 type 属性。值得注意的是， &lt;constructor-arg> 元素本身就有 type 属性，所以不必借助 &lt;value> 子元素来指定。</p>
  <p>总之，我们总能通过指定 type 属性来精确匹配方法。</p>
</div>
  
</body>
</html>